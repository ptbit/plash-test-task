var DataOcean=DataOcean||{},doev=(DataOcean.userEventCache=DataOcean.userEventCache||[],DataOcean.BluewhalePortal||(DataOcean.BluewhalePortal={bwTrck:{activityMonitor:{isMonitoringActive:!1,isUserActive:!1,activityTimeEventId:null,activityTimeEventTypeId:8,userTotalActivityTime:0,lastUserActivityTime:0,lastCheckUserActivityTime:0,checkUserActivityInterval:1e3,userIdleTimeThreshold:3e4,sendUserActivityTimeEventInterval:1e4,hadActivityDetected:!1,init:function(e,t,n,i){var r=DataOcean.BluewhalePortal.bwTrck.activityMonitor,e=(r.activityTimeEventId=e,r.checkUserActivityInterval=t||r.checkUserActivityInterval,r.userIdleTimeThreshold=n||r.userIdleTimeThreshold,r.sendUserActivityTimeEventInterval=i||r.sendUserActivityTimeEventInterval,r.isMonitoringActive=!0,r.isUserActive=!0,(new Date).getTime());r.lastUserActivityTime=e,r.lastCheckUserActivityTime=e,r.userTotalActivityTime=e-window.performance.timing.navigationStart,setInterval(r.checkUserActivity,r.checkUserActivityInterval),r.sendUserTotalActivityTimeEvent(),setInterval(function(){r.isUserActive&&r.sendUserTotalActivityTimeEvent()},r.sendUserActivityTimeEventInterval),r.setListenersForUserActivity()},reset:function(){var e,t=DataOcean.BluewhalePortal.bwTrck.activityMonitor;t.isMonitoringActive&&(t.isUserActive=!0,e=(new Date).getTime(),t.lastUserActivityTime=e,t.lastCheckUserActivityTime=e,t.userTotalActivityTime=0)},checkUserActivity:function(){var e=DataOcean.BluewhalePortal.bwTrck.activityMonitor,t=(new Date).getTime(),n=(e.hadActivityDetected&&(e.lastUserActivityTime=(new Date).getTime(),e.hadActivityDetected=!1),t-e.lastUserActivityTime);document.hidden||n>e.userIdleTimeThreshold?(e.isUserActive&&e.sendUserTotalActivityTimeEvent(),e.isUserActive=!1):(e.isUserActive=!0,n=t-e.lastCheckUserActivityTime,e.userTotalActivityTime=e.userTotalActivityTime+n),e.lastCheckUserActivityTime=t},sendUserTotalActivityTimeEvent:function(){var e=DataOcean.BluewhalePortal.bwTrck,t=(new Date).getTime(),n={utat:e.activityMonitor.userTotalActivityTime};e.logEvent(e.activityMonitor.activityTimeEventId,t,n,e.activityMonitor.activityTimeEventTypeId)},setListenersForUserActivity:function(){var e=DataOcean.BluewhalePortal.bwTrck.activityMonitor;document.addEventListener("keypress",e.onUserActivityEvent),document.addEventListener("keydown",e.onUserActivityEvent),document.addEventListener("keyup",e.onUserActivityEvent),document.addEventListener("mousedown",e.onUserActivityEvent),document.addEventListener("mouseup",e.onUserActivityEvent),document.addEventListener("mousemove",e.onUserActivityEvent),document.addEventListener("scroll",e.onUserActivityEvent)},onUserActivityEvent:function(){DataOcean.BluewhalePortal.bwTrck.activityMonitor.hadActivityDetected=!0}},scrollMonitor:{isScrollMonitoringActive:!1,lastScrollEventCheck:0,scrollEventCheckMinInterval:100,scrollTypeEventTypeId:13,monitoredEvents:{},init:function(t){var e=DataOcean.BluewhalePortal.bwTrck.scrollMonitor;document.querySelectorAll(t.selector).forEach(function(e){null===e.getAttribute("bd-scroll-pt")&&e.setAttribute("bd-scroll-pt",t.parameters.pt)}),e.monitoredEvents[t.eventId]=t,e.isScrollMonitoringActive||(e.setListenersForScrollActivity(),e.isScrollMonitoringActive=!0)},reset:function(){var e=DataOcean.BluewhalePortal.bwTrck.scrollMonitor;if(e.isScrollMonitoringActive){e.monitoredEvents={};for(var t=DataOcean.BluewhalePortal.bwTrck.monitoringSettings.events,n=0;n<t.length;n++){var i=t[n];i.eventTypeId===DataOcean.BluewhalePortal.bwTrck.scrollMonitor.scrollTypeEventTypeId&&e.init(i)}}},setListenersForScrollActivity:function(){var e=DataOcean.BluewhalePortal.bwTrck.scrollMonitor;document.addEventListener("keypress",e.onUserScrollHandler),document.addEventListener("scroll",e.onUserScrollHandler)},onUserScrollHandler:function(){var e=DataOcean.BluewhalePortal.bwTrck.scrollMonitor,t=(new Date).getTime();t-e.lastScrollEventCheck>e.scrollEventCheckMinInterval&&(e.checkMonitoredEvents(),e.lastScrollEventCheck=t)},checkMonitoredEvents:function(){var r=DataOcean.BluewhalePortal.bwTrck.scrollMonitor;Object.keys(r.monitoredEvents).forEach(function(i){var e=r.monitoredEvents[i].selector;document.querySelectorAll(e).forEach(function(e){for(var t=JSON.parse(e.getAttribute("bd-scroll-pt")||"[]"),n=r.calcElemScrollPerc(e);0!==t.length&&!(n<t[0]);)r.sendScrollMonitorEvent(e,r.monitoredEvents[i],{threshold:t[0]}),t.shift(),e.setAttribute("bd-scroll-pt",JSON.stringify(t))})})},calcElemScrollPerc:function(e){var t=window.innerHeight||document.documentElement.clientHeight,e=e.getBoundingClientRect();return Math.round(-1*(e.top-t)/e.height*100)},sendScrollMonitorEvent:function(e,t,n){try{var i=DataOcean.BluewhalePortal.bwTrck,r=i.getMonitoredAttributes(e,t.attributes,event);if(n)for(var o in n)r[o]=n[o];var a=(new Date).getTime();i.logEvent(t.eventId,a,r,i.scrollMonitor.scrollTypeEventTypeId)}catch(e){console.log(e)}}},VIEW_TIMER:null,VIEW_TIMEOUT:1e3,BASE_DOMAIN:"https://squid.gazeta.pl",LIQUID_DOMAIN:"https://liquid.agora.pl",USER_EVENT_URL:"",EVENT_TYPE_ID:1,BLUEWHALE_IFRAME_URL:"",BLUEWHALE_IFRAME_ID:"bluewhalePortalIframe",BLUEWHALE_IFRAME_PARAMS:{},BLUEWHALE_IFRAME:{},APPEND_IFRAME_RETRY_INTERVAL:500,COOKIE_SYNC_IFRAME_URL:"",COOKIE_SYNC_IFRAME_ID:"bluewhaleCookieSyncIframe",COOKIE_SYNC_IFRAME_PARAMS:{},COOKIE_SYNC_IFRAME:{},PAGE_VIEW_ID:"",ORIGINAL_PAGEVIEWID:"",VISIT_ID:"",BLUEWHALE_GUID:"",BLUEWHALE_GUID_COOKIE_NAME:"bwGuidv3",BLUEWHALE_GUID_OLD_COOKIE_NAME:"bwGuidv2",VISIT_ID_COOKIE_NAME:"bwVisitId",PAGE_VIEW_ID_COOKIE_NAME:"bwPageviewId",PIXELS:[],PIXELS_CONSENT:!1,VERSION:"3.0.15",MONITORING_INITIATED:!1,FIRST_PAGEVIEW_SENT:!1,monitoringSettings:{},CUSTOM_EVENTS:{},VIDEO_IFRAME_SELECTOR:"iframe[src^='http://www.gazeta.tv'],iframe[src^='https://www.gazeta.tv']",LAST_VIEW_CHANGE:0,videoIframes:[],delayEvents:[],userEventCacheNewItemEventName:"userEventCacheNewItemReceived",IFRAME_TITLE:"BWS ",init:function(){this.USER_EVENT_URL=this.BASE_DOMAIN+"/bdtrck/updDcUe",this.BLUEWHALE_IFRAME_URL=this.BASE_DOMAIN+"/bdtrck/getBdIf2",this.COOKIE_SYNC_IFRAME_URL=this.LIQUID_DOMAIN+"/bdtrck/getScIf";var e=DataOcean.BluewhalePortal.bwTrck,t=e.BLUEWHALE_IFRAME_URL,i=e.COOKIE_SYNC_IFRAME_URL,n=this.BLUEWHALE_IFRAME_PARAMS,r=this.COOKIE_SYNC_IFRAME_PARAMS;if(n.domain=window.location.hostname||"",n.visitedUrl=window.location.href||"",n.referer=document.referrer||"",n.portallogin=e.getCookieValue("UserID")||"",n.bluewhaleguid=e.getCookieValue(e.BLUEWHALE_GUID_OLD_COOKIE_NAME)||"",n.visitid=e.getCookieValue(e.VISIT_ID_COOKIE_NAME)||"",n.scriptversion=e.VERSION,n.rnd=(""+Math.random()).substring(3),n.xxroot=e.getRootXX()||"",e.testCookie()||(n.nocookie="1"),"undefined"!=typeof gfkSstConf&&(n.gfkmedia=gfkSstConf.media||"",gfkSstConf.content))for(var o=["gfkroot","gfktype","gfktemplate","gfkparam"],a=gfkSstConf.content.split("--"),c=0;c<a.length;c++)n[o[c]]=a[c]||"";function s(e){var t=e.origin||e.originalEvent&&e.originalEvent.origin;if(t&&t===DataOcean.BluewhalePortal.bwTrck.BASE_DOMAIN){t=e.data||e.originalEvent&&e.originalEvent.data,e=DataOcean.BluewhalePortal.bwTrck;if(t&&-1<t.indexOf("BDIFRAMEREADY")&&!e.FIRST_PAGEVIEW_SENT){e.FIRST_PAGEVIEW_SENT=!0;e.BLUEWHALE_IFRAME.contentWindow.postMessage(JSON.stringify({first_pageview:!0}),"*")}else if(t&&-1<t.indexOf("IFRAMELOADED")){var n={};try{n=JSON.parse(t)}catch(e){}e.PAGE_VIEW_ID=n.pageviewid||"",e.VISIT_ID=n.visitid||"",e.BLUEWHALE_GUID=n.guid||"",e.PIXELS=n.pixels||[];t=e.getMainDomainForCookie(),t=(e.setCookie(e.BLUEWHALE_GUID_OLD_COOKIE_NAME,e.BLUEWHALE_GUID,8760,"/",t,1),e.setCookie(e.VISIT_ID_COOKIE_NAME,e.VISIT_ID,.5,"/",t,1),e.setCookie(e.PAGE_VIEW_ID_COOKIE_NAME,e.PAGE_VIEW_ID,1,"/",t,1),e.MONITORING_INITIATED?(e.activityMonitor.reset(),e.scrollMonitor.reset()):(e.ORIGINAL_PAGEVIEWID=n.pageviewid||"",e.videoIframes=Array.prototype.slice(document.querySelectorAll(e.VIDEO_IFRAME_SELECTOR)),e.monitoringSettings=n.monitoringsettings||{},e.initMonitoring(),e.PIXELS_CONSENT&&e.getPixels(e.PIXELS)),r.bluewhaleguid=e.BLUEWHALE_GUID,r.visitid=e.VISIT_ID,r.pageviewid=e.PAGE_VIEW_ID,e.prepareUrl(i,r));e.COOKIE_SYNC_IFRAME=e.createIframe(t,e.COOKIE_SYNC_IFRAME_ID,e.IFRAME_TITLE)}}}var l="",l=("string"==typeof banCookie?l=banCookie:"object"==typeof banCookie&&"string"==typeof banCookie.banCookie&&(l=banCookie.banCookie),n.adservercid=l.substring(20,l.length-6),"gazetapraca.pl"===n.domain?e._getGazetapracaLogin():n.domain.match(/goldenline.pl$/)?"undefined"!=typeof CURRENT&&(n.gluserid=CURRENT.id||""):n.domain.match(/publio.pl$/)&&(l=document.querySelector("a.username"))&&(n.publiologin=l.innerHTML||""),e.getCookieValue("USER_PROF")),l=("string"==typeof l&&(n.userprof=l),e.getCookieValue("profileName")),l=("string"==typeof l&&(n.profilename=l),e.getCookieValue("group")),l=("string"==typeof l&&(n.group=l),e.getCookieValue("hpptab")),l=("string"==typeof l&&(n.hpptab=l),e.getCookieValue("hptab")),l=("string"==typeof l&&(n.hptab=l),e.getCookieValue("mhptab")),l=("string"==typeof l&&(n.mhptab=l),e.getCookieValue("alltab")),l=("string"==typeof l&&(n.alltab=l),"undefined"!=typeof gwReferrer&&(n.gwReferrer=gwReferrer),void 0!==window.site_details&&Object.keys(window.site_details).forEach(function(e){n["sd_"+e]=window.site_details[e]}),void 0!==window.uniid&&(void 0!==window.uniid.pubid&&(n.uni_pubid=window.uniid.pubid),void 0!==window.uniid.adid&&(n.uni_adid=window.uniid.adid),void 0!==window.uniid.hid&&(n.uni_hid=window.uniid.hid),void 0!==window.uniid.consent)&&(n.uni_consent=window.uniid.consent),e.getOneTrustGroups()),l=(l&&(n.ot_groups=l,e.PIXELS_CONSENT=e.getPixelConsent(l)),e.getCookieValue("_ga")),l=("string"==typeof l&&(n.cookie_ga=l),this.jqueryEnabled()&&jQuery(window).bind?jQuery(window).bind("message",s):window.addEventListener?window.addEventListener("message",s,!1):window.attachEvent&&window.attachEvent("onmessage",s),e.prepareUrl(t,n));e.BLUEWHALE_IFRAME=e.createIframe(l,e.BLUEWHALE_IFRAME_ID,e.IFRAME_TITLE)},getOneTrustGroups:function(){try{var e,t=DataOcean.BluewhalePortal.bwTrck,n=t.getCookieValue("OptanonConsent");return null!=n?(e=t.getParamValue(n,"groups"))&&e.replace("V2STACK42:","STACK42:"):null}catch(e){return"error"}},getPixelConsent:function(t){var e=window.site_details&&window.site_details.tcf_r,n=e&&window.site_details.tcf_c;let i=n?n.split(",").map(Number):null;n=!!i&&[1,2,3,4,5,6,7,8,9,10,11].every(e=>i.includes(e));return e?n:t&&["C0001:1","C0002:1","C0003:1","C0004:1","STACK42:1"].every(e=>t.includes(e))},_getGazetapracaLogin:function(){var e=null,t="#e8 .mail span";if(this.jqueryEnabled()){var n=jQuery(t);0<n.length&&(e=n[0])}else try{e=document.querySelector(t)}catch(e){}e&&(DataOcean.BluewhalePortal.bwTrck.BLUEWHALE_IFRAME_PARAMS.gazetapracalogin=e.textContent)},jqueryEnabled:function(){return"undefined"!=typeof jQuery},getPixels:function(e){for(var t=0;t<e.length;t++)try{new Image(1,1).src=e[t]}catch(e){}},initMonitoring:function(){if(!this.MONITORING_INITIATED){if(this.CUSTOM_EVENTS={view:this.createCustomEvent("view"),hide:this.createCustomEvent("hide"),firstview:this.createCustomEvent("firstview")},this.monitoringSettings&&this.monitoringSettings.events&&0<this.monitoringSettings.events.length){this.monitoringSettings.view=[],this.monitoringSettings.firstview=[],this.setViewEventListeners(),this.setDelayEventsListener();for(var e=0;e<this.monitoringSettings.events.length;e++)try{var t,n=this.monitoringSettings.events[e];n.parameters=this.parseParamTypes(n.parameters),n.eventTypeId===DataOcean.BluewhalePortal.bwTrck.activityMonitor.activityTimeEventTypeId?(t=DataOcean.BluewhalePortal.bwTrck.activityMonitor).isMonitoringActive||t.init(n.eventId,n.parameters.cuau,n.parameters.uitt,n.parameters.suatei):n.eventTypeId===DataOcean.BluewhalePortal.bwTrck.scrollMonitor.scrollTypeEventTypeId?DataOcean.BluewhalePortal.bwTrck.scrollMonitor.init(n):(!n.parameters.delay||"complete"===document.readyState||"interactive"===document.readyState||"loaded"===document.readyState?this.setUserEventListener(n):this.delayEvents.push(n),"view"===n.domEventName||"hide"===n.domEventName?this.monitoringSettings.view.push(n):"firstview"===n.domEventName?this.monitoringSettings.firstview.push(n):n.parameters.isa&&(this.CUSTOM_EVENTS[n.domEventName]=this.CUSTOM_EVENTS[n.domEventName]||this.createCustomEvent(n.domEventName),this.onActiveMonitoring(n)),n.parameters&&n.parameters.chkf&&this.iterateElementsFromEventDefs([n],function(e){n.parameters.chkf(e)&&this.onEvent({target:e},n,{bm:1})}.bind(this)))}catch(e){}}this.MONITORING_INITIATED=!0,this.processUserEventCache(),document.addEventListener(this.userEventCacheNewItemEventName,this.processUserEventCache),DataOcean.userEventCache.push=function(e){Array.prototype.push.call(DataOcean.userEventCache,e);e=DataOcean.BluewhalePortal.bwTrck;e.fireCustomEvent(e.userEventCacheNewItemEventName,document)},this.monitoringSettings.view&&this.onView()}},createCustomEvent:function(e){var t;return document.createEvent?(t=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(t=document.createEventObject()).eventType=e,t.eventName=e,t},fireCustomEvent:function(e,t){e=DataOcean.BluewhalePortal.bwTrck.CUSTOM_EVENTS[e]||this.createCustomEvent(e);document.createEvent?t.dispatchEvent(e):t.fireEvent("on"+e.eventType,e)},processUserEventCache:function(){for(;0!==DataOcean.userEventCache.length;)DataOcean.BluewhalePortal.bwTrck.logCachedEvent(DataOcean.userEventCache.shift())},prepareUrl:function(e,t){var n,i="";for(n in t)null!=t[n]&&""!==t[n]&&(i+=encodeURIComponent(n)+"="+encodeURIComponent(t[n])+"&");return e+"?"+i},getMainDomainForCookie:function(){if(-1!=window.location.hostname.indexOf(".")){var e=window.location.hostname.split("."),t="."+e.pop();do{var n=e.pop()}while(n&&(t="."+n+t),n&&n.length<=3);return t}},getCookieValue:function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return unescape(r.substring(t.length,r.length))}return null},getParamValue:function(e,t){for(var n=t+"=",i=e.split("&"),r=0;r<i.length;r++){var o=i[r];if(0===o.indexOf(n))return unescape(o.substring(n.length))}return null},setCookie:function(e,t,n,i,r,o){var a=(new Date).getTime(),a=(n=n&&1e3*n*60*60,new Date(a+n));document.cookie=e+"="+escape(t)+(n?";expires="+a.toGMTString():"")+(i?";path="+i:"")+(r?";domain="+r:"")+(o?";secure":"")},testCookie:function(){var e="squidtestcookie",t=navigator.cookieEnabled||!1;return t||(document.cookie=e,t=-1!==document.cookie.indexOf(e)),t},getRootXX:function(){return"undefined"!=typeof gazeta_pl&&gazeta_pl.rootSectionId||""},appendIframe:function(t){var e=document.body;try{e.appendChild(t)}catch(e){setTimeout(this.appendIframe.bind(this,t),this.APPEND_IFRAME_RETRY_INTERVAL)}},createIframe:function(e,t,n){var i=document.createElement("iframe"),r=(i.setAttribute("style","position:absolute;left:-9999px;top:0;width:1px;height:1px;"),(new Date).getTime());return i.setAttribute("title",n+r),i.id=t,i.src=e,this.appendIframe(i),i},setViewEventListeners:function(){this.jqueryEnabled()&&jQuery(window).bind?jQuery(window).bind("DOMContentLoaded load resize scroll click",this.onView):window.addEventListener?(addEventListener("DOMContentLoaded",this.onView,!1),addEventListener("load",this.onView,!1),addEventListener("scroll",this.onView,!1),addEventListener("resize",this.onView,!1),addEventListener("click",this.onView,!1)):window.attachEvent&&(attachEvent("onDOMContentLoaded",this.onView),attachEvent("onload",this.onView),attachEvent("onscroll",this.onView),attachEvent("onresize",this.onView),attachEvent("onclick",this.onView)),this.jqueryEnabled()&&jQuery(document).bind?jQuery(document).bind("visibilitychange",this.onView):document.addEventListener?document.addEventListener("visibilitychange",this.onView,!1):window.attachEvent&&document.attachEvent("onvisibilitychange",this.onView),document.querySelectorAll("[data-bd-scroll-elem]").forEach(e=>{e.addEventListener("scroll",this.onView,!1)})},setDelayEventsListener:function(){function e(){for(;0!==t.delayEvents.length;)t.setUserEventListener(t.delayEvents.pop())}var t=DataOcean.BluewhalePortal.bwTrck;window.addEventListener?addEventListener("DOMContentLoaded",e,!1):window.attachEvent&&attachEvent("onDOMContentLoaded",e)},setUserEventListener:function(n){function t(e){var t=e.target||e.srcElement;this.matchesSelector(t,n.selector,n.binder)&&this[n.handler](e,n)}function e(e){t.call(r,e)}var i=n.binder||"document",r=DataOcean.BluewhalePortal.bwTrck,o=("window"===i?i=window:"document"===i?i=document:0===i.indexOf("function")&&(i=new Function("return "+i)()()),"string"==typeof i?document.querySelectorAll(i):[i]);if(window.addEventListener)for(var a=0;a<o.length;a++)o[a].addEventListener(n.domEventName,e,!1);else if(window.attachEvent)for(a=0;a<o.length;a++)o[a].attachEvent("on"+n.domEventName,e)},matchesSelector:function(e,t,n){if("*"===t)return!0;if("window"===t)return e===window;if("document"===t)return e===document;var i=window.Element.prototype,i=i.matches||i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.webkitMatchesSelector;if(i&&"function"==typeof e[i.name])return i.call(e,t);if("function"==typeof n.querySelectorAll)for(var r=(n=n||document).querySelectorAll(t),o=0;o<r.length;o++)if(r[o]===e)return!0;return!1},getVisiblePercentage:function(e){if(document.visibilityState&&"visible"===document.visibilityState||!document.visibilityState){var e=e.getBoundingClientRect(),t=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,t=(e.bottom>t?t:e.bottom)-(e.top<0?0:e.top),n=(n<e.right?n:e.right)-(e.left<0?0:e.left);if(0<t&&0<n)return t/e.height*(n/e.width)}return 0},isElementVisible:function(e,t){var n,i,r,o,a=DataOcean.BluewhalePortal.bwTrck.isElementNotCovered,c=e.getBoundingClientRect(),s=window.innerHeight||document.documentElement.clientHeight,l=window.innerWidth||document.documentElement.clientWidth,d=(c.bottom>s?s:c.bottom)-(c.top<0?0:c.top),u=(l<c.right?l:c.right)-(c.left<0?0:c.left);return!(d<=0||u<=0)&&(r=t.eh||1,o=t.ew||1,n=0<u?Math.max(c.left,0)+u*(t.cpx||.5):-1,i=0<d?Math.max(c.top,0)+d*(t.cpy||.5):-1,c.height*r<=d&&u>=c.width*o||s*(t.vh||.5)<=d&&l*(t.vw||.5)<=u||(r=c.top+c.height*(t.elbt||1),o=c.left+c.width*(t.ellf||0),d=c.left+c.width*(t.elrt||1),0<=(u=c.top+c.height*(t.eltp||0))&&u<=s&&0<=r&&r<=s&&0<=o&&o<=l&&0<=d&&d<=l))&&a(e,n,i)},isElementNotCovered:function(e,t,n){var i;return void 0===document.elementFromPoint||(t=document.elementFromPoint(t,n),i="contains"==(n="contains"in e?"contains":"compareDocumentPosition")?1:20,null!=t&&(t==e||e[n](t)==i||t[n](e)==i))},onView:function(e){var t;(document.visibilityState&&"visible"===document.visibilityState||!document.visibilityState)&&(t=DataOcean.BluewhalePortal.bwTrck,e&&(t.LAST_VIEW_CHANGE=e.timeStamp||(new Date).getTime()),window.clearTimeout(DataOcean.BluewhalePortal.bwTrck.VIEW_TIMER),t.VIEW_TIMER=setTimeout(function(){t.checkViewEvents()},t.VIEW_TIMEOUT))},onEventWithTimeout:function(e,t,n){var i=DataOcean.BluewhalePortal.bwTrck,r=t.parameters.sto||0;setTimeout(function(){i.onEvent(e,t,n)},r)},onEvent:function(e,t,n){var i=t.parameters.chkev||function(){return!0};try{if(i(e)){var r=DataOcean.BluewhalePortal.bwTrck,o=(new Date).getTime(),a=e.target||e.srcElement||window,c=r.getMonitoredAttributes(a,t.attributes,e);if(n)for(var s in n)c[s]=n[s];r.logEvent(t.eventId,o,c,t.eventTypeId)}}catch(e){}},onMessage:function(e,t){var n,e=e.originalEvent||e,i=DataOcean.BluewhalePortal.bwTrck,r=t.parameters.dfunc||function(){return null};if(t.parameters.morig&&!(t.parameters.morig.indexOf(e.origin)<0))try{(n=r(e.data))&&i.onEvent(e,t,n)}catch(e){}},getVideoState:function(e){switch(e){case"playing":return"playingVideo";case"begin":case"firstQuartile":case"midpoint":case"thirdQuartile":case"resume":return"playingAd";default:return"notPlaying"}},refreshVideoState:function(e,t){t=DataOcean.BluewhalePortal.bwTrck.getVideoState(t);e.bdvideostate!==t&&(e.bdvideostate=t)},onVideo:function(e,t){var e=e.originalEvent||e,n=DataOcean.BluewhalePortal.bwTrck,i={},r=[];if(t.parameters.morig&&!(t.parameters.morig.indexOf(e.origin)<0)){try{i=JSON.parse(e.data),r=JSON.parse(t.parameters.struc)}catch(e){}for(var o,a=!1,c=0;c<r.length&&!(a=n.checkStructure(i,r[c]));c++);a&&(null!==(o=n.getSourceIframe(e))&&i.state&&n.refreshVideoState(o,i.state),i.vurl=null!==o?o.src:"",n.onEvent(e,t,i))}},onVideoOnNetwork:function(e,t){var e=e.originalEvent||e,n=DataOcean.BluewhalePortal.bwTrck,i={},r=[];if(attrs_filter=[],e.data&&"string"==typeof e.data&&!(e.data.indexOf("onntv://")<0)){try{attrs_filter=JSON.parse(t.parameters.fattr),i=JSON.parse(e.data.replace("onntv://","")),r=JSON.parse(t.parameters.struc)}catch(e){}for(var o=!1,a=0;a<r.length&&!(o=n.checkStructure(i,r[a]));a++);o&&n.onEvent(e,t,n.filterAttrs(i,attrs_filter))}},filterAttrs:function(e,t){var n,i={};for(n in e)0<=t.indexOf(n)&&(i[n]=e[n]);return i},onActiveMonitoring:function(e){var n=e.parameters;this.iterateElementsFromEventDefs([e],function(e,t){n.afunc&&n.afunc.call(this,e,t),n.chksnd.call(this,e,t)&&this.fireCustomEvent(t.domEventName,e)}.bind(this)),n.chkstp.call(this,e)||setTimeout(this.onActiveMonitoring.bind(this,e),n.tmo)},onDynamicPV:function(e){var t=DataOcean.BluewhalePortal.bwTrck,n={visitedUrl:window.location.href||"",domain:window.location.hostname||"",referer:t.BLUEWHALE_IFRAME_PARAMS.visitedUrl||"",opvid:t.ORIGINAL_PAGEVIEWID||"",pageview:!0};if(void 0!==window.site_details)for(key in window.site_details)n["sd_"+key]=window.site_details[key];var i=JSON.stringify(n);t.BLUEWHALE_IFRAME.contentWindow.postMessage(i,"*"),t.BLUEWHALE_IFRAME_PARAMS.visitedUrl=n.visitedUrl,t.BLUEWHALE_IFRAME_PARAMS.referer=n.referer,t.activityMonitor.sendUserTotalActivityTimeEvent()},getSourceIframe:function(e){for(var t=DataOcean.BluewhalePortal.bwTrck,n=0;n<t.videoIframes.length;n++)if(t.videoIframes[n].contentWindow===e.source)return t.videoIframes[n];for(var i=document.querySelectorAll(t.VIDEO_IFRAME_SELECTOR),r=i.length-1;0<=r;r--)if(i[r].contentWindow===e.source)return t.videoIframes.push(i[r]),i[r];return null},checkStructure:function(e,t){for(var n in t)if(t[n].indexOf(e[n])<0)return!1;return!0},checkViewEvents:function(){var n=DataOcean.BluewhalePortal.bwTrck;n.iterateElementsFromEventDefs(n.monitoringSettings.view,function(e,t){t=n.isElementVisible(e,t.parameters||{});(e.isVisible||!1)^t&&(n.fireCustomEvent(t?"view":"hide",e),e.isVisible=t)}),n.iterateElementsFromEventDefs(n.monitoringSettings.firstview,function(e,t){!e.firstView&&n.isElementVisible(e,t.parameters||{})&&(n.fireCustomEvent("firstview",e),e.firstView=!0)})},iterateElementsFromEventDefs:function(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=[];if("window"===i.selector)r=[window];else if("document"===i.selector)r=[document];else{var o=[];"window"===i.binder&&(o=[window]);for(var o="document"!==i.binder&&i.binder?document.querySelectorAll(i.binder):[document],a=0;a<o.length;a++){var c=o[a].querySelectorAll(i.selector);Array.prototype.push.apply(r,c)}}for(var s=0;s<r.length;s++)t(r[s],i)}},getMonitoredAttributes:function(e,t,n){for(var i,r,o={},t=t||[],a=0;a<t.length;a++)try{if(i="string"==typeof t[a].object&&0===t[a].object.indexOf("function")?new Function("return "+t[a].object)()(e,n):e,null!==(r="string"==typeof t[a].value&&0===t[a].value.indexOf("function")?new Function("return "+t[a].value)()(i,n):i.getAttribute(t[a].value))&&"object"==typeof r)for(var c in r)r.hasOwnProperty(c)&&r[c]&&(o[c]=r[c]);else r&&(o[t[a].code]=r)}catch(e){}return o},parseParamTypes:function(e){if(null!==e&&"object"==typeof e)for(var t in e){var n;e.hasOwnProperty(t)&&e[t]&&"string"==typeof e[t]&&(0===e[t].indexOf("function")?(n=new Function("return "+e[t])(),e[t]=n):(n=parseFloat(e[t]),!isNaN(n)&&isFinite(e[t])&&(e[t]=n)))}return e},getEventContext:function(e){var t=DataOcean.BluewhalePortal.bwTrck,e=e||{};return e.vu=window.location.href,e.ld=window.location.hostname||"",e.pvid=t.PAGE_VIEW_ID||"",e.vid=t.VISIT_ID||"",e},logEvent:function(e,t,n,i){try{var r=DataOcean.BluewhalePortal.bwTrck,o={};o.e=e,o.et=i||r.EVENT_TYPE_ID,o.g=r.BLUEWHALE_GUID,o.t=[t],o.a=r.stringifyProperties(n),o.c=r.stringifyProperties(r.getEventContext(o.c)),r.sendEvent(o)}catch(e){}},stringifyProperties:function(e){for(var t in e)e.hasOwnProperty(t)&&("object"==typeof e[t]?e[t]=JSON.stringify(e[t]):e[t]=String(e[t]));return e},logCachedEvent:function(e){var t,n;void 0!==e&&e.e&&(t=DataOcean.BluewhalePortal.bwTrck,n=e.t||(new Date).getTime(),t.logEvent(e.e,n,e.a||{}))},sendEvent:function(e){var t=DataOcean.BluewhalePortal.bwTrck,e=JSON.stringify([e]);t.BLUEWHALE_IFRAME.contentWindow.postMessage(e,"*")}}},setTimeout(function(){try{DataOcean.BluewhalePortal.bwTrck.init()}catch(e){console.log(e)}},20)),function(e,t){var n;e&&(n=(new Date).getTime(),DataOcean.BluewhalePortal.bwTrck.logEvent(e,n,t=t||{}))}),dopv=function(){DataOcean.BluewhalePortal.bwTrck.MONITORING_INITIATED&&DataOcean.BluewhalePortal.bwTrck.onDynamicPV()};